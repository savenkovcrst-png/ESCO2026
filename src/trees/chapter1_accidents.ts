import type { DecisionTree } from "../decision/decisionTree";

export const chapter1_tree: DecisionTree = {
  id: "ch1",
  title: "Глава 1 — Аварии и их причины: классификация и первичные действия",
  startNodeId: "q_is_accident",
  nodes: {
    q_is_accident: {
      id: "q_is_accident",
      type: "question",
      title: "Событие требует специальных работ по извлечению/ликвидации?",
      help: "В книге аварией считают нарушение процесса из‑за прихвата/поломки/оставления предметов, когда нужны спецработы.",
      input: "yesno",
      edges: [
        { when: { eq: true }, to: "q_accident_kind", label: "да" },
        { when: { eq: false }, to: "r_not_accident", label: "нет" },
      ],
    },

    r_not_accident: {
      id: "r_not_accident",
      type: "result",
      severity: "low",
      title: "Это осложнение/нештатность без спецработ",
      actions: [
        "Зафиксировать параметры и время события.",
        "Стабилизировать режим бурения/промывки.",
        "Доложить мастеру и действовать по местным инструкциям.",
      ],
      notes: ["Если ситуация меняется и потребуются спецработы — вернитесь к ветке «Авария»."],
      references: [{ chapter: "Гл.1", section: "1.1 понятие и классификация" }],
    },

    q_accident_kind: {
      id: "q_accident_kind",
      type: "question",
      title: "Какой вид аварии ближе по признакам?",
      input: "select",
      options: [
        { value: "drillstring", label: "Авария с бурильной колонной (обрыв/срыв/падение элементов)" },
        { value: "stuck", label: "Прихват бурильной колонны" },
        { value: "casing", label: "Авария с обсадной колонной" },
        { value: "cement", label: "Авария из‑за неудачного цементирования" },
        { value: "motor", label: "Авария с забойным двигателем/турбобуром" },
        { value: "bit", label: "Авария с долотом" },
        { value: "foreign", label: "Падение посторонних предметов" },
        { value: "other", label: "Прочие виды аварий" },
      ],
      edges: [
        { when: { in: ["drillstring", "stuck", "casing", "cement", "motor", "bit", "foreign", "other"] }, to: "r_primary_actions" },
      ],
    },

    r_primary_actions: {
      id: "r_primary_actions",
      type: "result",
      severity: "high",
      title: "Первичные действия при аварии (оперативный старт)",
      actions: [
        "Остановить усугубляющие операции и обеспечить безопасность работ.",
        "Собрать исходные данные: глубина, компоновка, режим, давления/нагрузки, параметры раствора.",
        "При подозрении на поломку/оставление инструмента — немедленно приступить к подъёму колонны и уведомить мастера (или руководство при его отсутствии).",
        "Перейти к выбору методов ликвидации (Глава 2) и подбору ловильного инструмента (Глава 4).",
      ],
      notes: [
        "Неправильный выбор ловильного инструмента может усложнить аварию до ликвидации скважины — сначала анализ, потом действия.",
      ],
      references: [
        { chapter: "Гл.1", section: "виды аварий (1.2–1.8)" },
        { chapter: "Гл.2", section: "анализ перед ликвидацией" },
        { chapter: "Гл.1", section: "1.9 расследование и учёт" },
      ],
    },
  },
};
